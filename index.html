<html>

<head>
<title>Project 2 - INFO 5100 - Data-driven Web Pages</title>
<style>
	html {padding: 0; margin: 0;}
	body {font-family: "Avant Garde", Avantgarde, "Century Gothic", CenturyGothic, "AppleGothic", sans-serif; margin: 0;}
	svg {border: solid #ccc 1px; }
</style>
<link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Oleo+Script" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="css/styles.css">
<script src="https://d3js.org/d3.v4.min.js"></script>
</head>

<body>

	<div class="movie-main-container">

		<div class="movie-banner-container"></div>

		<div class="movie-title-container">
			
			<h1 class="title">The most popular 21st century movies</h1>

		</div>

		<div class="movie-visualization-container">

			<div class="inner-left-container">
				
				<h3>Choose filters</h3>

				<div class="styled-select orange rect-square">
				  <select>
				  	<option>Year - All</option>
				    <option>Year 2001 t0 2005</option>
				    <option>Year 2006 t0 2010</option>
				    <option>Year 2011 t0 2015</option>
				  </select>
				</div>

				<div class="styled-select orange rect-square">
				  <select>
				  	<option>Duration - All</option>
				    <option>Duration > 90 minutes</option>
				  </select>
				</div>

				<div class="styled-select orange rect-square">
				  <select>
				  	<option>Genre - All</option>
				    <option>Genre - Action</option>
				    <option>Genre - Adventure</option>
				    <option>Genre - Fantasy</option>
					<option>Genre - Sci-Fi</option>
					<option>Genre - Thriller</option>
					<option>Genre - Romance</option>
					<option>Genre - Animation</option>
					<option>Genre - Comedy</option>
					<option>Genre - Family</option>
					<option>Genre - Musical</option>
					<option>Genre - Mystery</option>
					<option>Genre - Western</option>
					<option>Genre - Drama</option>
					<option>Genre - History</option>
					<option>Genre - Sport</option>
					<option>Genre - Horror</option>
					<option>Genre - Crime</option>
					<option>Genre - War</option>
					<option>Genre - Biography</option>
					<option>Genre - Film-Noir</option>
					<option>Genre - Short</option>
				  </select>
				</div>

				<h3 class="second">Select 2 factors to plot</h3>
				
				<ul>
					<li>
						<input type="checkbox" class="css-checkbox" id="budget" name="factor" value="budget" />
						<label class="css-label" for="budget">Movie budget</label>
					</li>
					<li>
						<input type="checkbox" class="css-checkbox" id="imdbScore" name="factor" value="imdbScore" /> 
						<label class="css-label" for="imdbScore">Imdb rating</label>
					</li>
					<li>
						<input type="checkbox" class="css-checkbox" id="gross" name="factor" value="gross" /> 
						<label class="css-label" for="gross">Gross earnings</label>
					</li>
					<li>
						<input type="checkbox" class="css-checkbox" id="movieLikes" name="factor" value="movieLikes" /> 
						<label class="css-label" for="movieLikes">Movie facebook likes</label>
					</li>
					<li>
						<input type="checkbox" class="css-checkbox" id="actorLikes" name="factor" value="actorLikes" /> 
						<label class="css-label" for="actorLikes">Lead actor facebook likes</label>
					</li>
				</ul>

				<button type="button" class="view-graph-btn">Show Movies</button>

			</div>

			<div class="inner-right-container"></div>

		</div>

	</div>

<script>
	//Declare variables
	var movieData = [];
	var awardData = [];

	//organize data
	var parseRow1 = function(line){
		return {
			//Filter data
			duration: Number(line["duration"]),
			genres: line["genres"],
			year: Number(line["title_year"]),
			country: line["country"],
			language: line["language"], //not actual filter

			//Factor data
			actorLikes: Number(line["actor_1_facebook_likes"]),
			budget: Number(line["budget"]),
			gross: Number(line["gross"]),
			score: Number(line["imdb_score"]),
			movieLikes: Number(line["movie_facebook_likes"]),

			//Movie Info data
			title: line["movie_title"],
			keywords: line["plot_keywords"],
			link: line["movie_imdb_link"],
		}
	};

	var parseRow2 = function(line){
		return {
			year: Number(line["Year"]),
			award: line["Award"],
			filmName: line["Film"],
		}
	};

	d3.queue()
	.defer(d3.csv, "movie_metadata.csv", parseRow1)
	.defer(d3.csv, "award.csv", parseRow2)
	.await(function(error, data, award){
		award.forEach(function(d){
			if(d.year>2000){
				awardData.push(d);
			}
		});

		data.forEach(function(d){
			if(d.duration && d.genres && d.year>2000 && d.country && d.language == "English" && d.actorLikes && d.budget && d.gross && d.score && d.movieLikes && d.title && d.keywords && d.link){
				movieData.push(d);
			}
		});

		var count1 = 0;
		var count2 = 0;
		var index = 0;
		movieData.forEach(function(movie){
			awardData.forEach(function(award){
				//** if we compare movies with both name and year, it has 792 movies; if we only check the names, there are 812. And there are 1 film with multiple awards
				//stuck on 1: duplicated awards 2: delete non-awarded films
				if(movie.title.toUpperCase().trim() === award.filmName.toUpperCase()  && movie.year == award.year){
					// if(!movie.award){
					// 	movie.award = award.award;
					// }
					movie.award = award.award;
					count1++;
				}
				else{
					index = movieData.indexOf(movie);
					console.log(index);
					movieData.splice(index,1);
					count2++;
				}
			})
			//console.log(movie.award);
		})

				console.log("1: "+ count1 +" "+ "2: "+count2);
	})
</script>
<!-- References: 
select dropdown styling: https://codepen.io/ericrasch/pen/zjDBx
checkbox styling: http://www.csscheckbox.com/checkbox/42432/padded-orange-check/
-->
</body>

</html>